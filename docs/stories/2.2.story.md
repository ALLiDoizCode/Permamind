# Story 2.2: Implement Claude Code Slash Command Integration

## Status

Pending

## Story

**As a** Claude Code user with BMAD installed,
**I want** to use clean slash commands for all BMAD functionality,
**so that** I can access agents, tasks, templates, checklists, and workflows efficiently.

## Acceptance Criteria

1. Create agent slash commands: /analyst, /architect, /dev, /pm, /qa, /sm, /ux-expert, /bmad-master
2. Create task slash commands: /advanced-elicitation, /create-doc, /execute-checklist, /brownfield-create-epic, etc. (all 20 tasks)
3. Create template slash commands: /architecture, /prd, /story, /front-end-spec, etc. (all 15 templates)
4. Create checklist slash commands: /architect-checklist, /pm-checklist, /story-dod-checklist, etc. (all 7 checklists)
5. Create workflow slash commands: /greenfield-fullstack, /brownfield-service, etc. (all 6 workflows)
6. Ensure slash commands integrate with Claude Code's command system
7. Maintain parameter passing and execution patterns from original BMAD tools

## Tasks / Subtasks

- [ ] **Create Agent Slash Commands** (AC: 1)
  - [ ] Implement /analyst slash command
  - [ ] Implement /architect slash command  
  - [ ] Implement /dev slash command
  - [ ] Implement /pm slash command
  - [ ] Implement /qa slash command
  - [ ] Implement /sm slash command
  - [ ] Implement /ux-expert slash command
  - [ ] Implement /bmad-master slash command
  - [ ] Each command loads appropriate agent persona from .bmad-core/agents/

- [ ] **Create Task Slash Commands** (AC: 2)
  - [ ] Implement /advanced-elicitation command
  - [ ] Implement /analyze-ao-process-requirements command
  - [ ] Implement /brownfield-create-epic command
  - [ ] Implement /brownfield-create-story command
  - [ ] Implement /correct-course command
  - [ ] Implement /create-brownfield-story command
  - [ ] Implement /create-deep-research-prompt command
  - [ ] Implement /create-doc command
  - [ ] Implement /create-next-story command
  - [ ] Implement /design-ao-process-architecture command
  - [ ] Implement /document-project command
  - [ ] Implement /execute-checklist command
  - [ ] Implement /facilitate-brainstorming-session command
  - [ ] Implement /generate-ai-frontend-prompt command
  - [ ] Implement /implement-ao-process command
  - [ ] Implement /index-docs command
  - [ ] Implement /kb-mode-interaction command
  - [ ] Implement /review-story command
  - [ ] Implement /shard-doc command
  - [ ] Implement /validate-next-story command

- [ ] **Create Template Slash Commands** (AC: 3)
  - [ ] Implement /ao-process-architecture command
  - [ ] Implement /ao-process-requirements command
  - [ ] Implement /architecture command
  - [ ] Implement /brainstorming-output command
  - [ ] Implement /brownfield-architecture command
  - [ ] Implement /brownfield-prd command
  - [ ] Implement /competitor-analysis command
  - [ ] Implement /front-end-architecture command
  - [ ] Implement /front-end-spec command
  - [ ] Implement /fullstack-architecture command
  - [ ] Implement /market-research command
  - [ ] Implement /prd command
  - [ ] Implement /project-brief command
  - [ ] Implement /story command
  - [ ] Each command uses template from .bmad-core/templates/

- [ ] **Create Checklist Slash Commands** (AC: 4)
  - [ ] Implement /ao-process-qa-checklist command
  - [ ] Implement /architect-checklist command
  - [ ] Implement /change-checklist command
  - [ ] Implement /pm-checklist command
  - [ ] Implement /po-master-checklist command
  - [ ] Implement /story-dod-checklist command
  - [ ] Implement /story-draft-checklist command
  - [ ] Each command loads checklist from .bmad-core/checklists/

- [ ] **Create Workflow Slash Commands** (AC: 5)
  - [ ] Implement /greenfield-fullstack command
  - [ ] Implement /greenfield-service command
  - [ ] Implement /greenfield-ui command
  - [ ] Implement /brownfield-fullstack command
  - [ ] Implement /brownfield-service command
  - [ ] Implement /brownfield-ui command
  - [ ] Each command executes workflow from .bmad-core/workflows/

- [ ] **Integrate with Claude Code Command System** (AC: 6)
  - [ ] Research Claude Code slash command registration mechanism
  - [ ] Create slash command registry service
  - [ ] Implement command discovery and registration
  - [ ] Handle command conflicts and validation
  - [ ] Ensure commands appear in Claude Code command palette

- [ ] **Maintain BMAD Tool Patterns** (AC: 7)
  - [ ] Preserve parameter passing from BMAD tools
  - [ ] Maintain elicitation and interaction patterns
  - [ ] Keep resource loading and processing logic
  - [ ] Preserve error handling and validation
  - [ ] Maintain output formatting and user experience

- [ ] **Testing and Validation**
  - [ ] Create unit tests for all slash command implementations
  - [ ] Test command registration and discovery
  - [ ] Test parameter passing and execution
  - [ ] Test integration with .bmad-core resources
  - [ ] Verify no conflicts with existing Claude Code commands

- [ ] **Quality Assurance**
  - [ ] Run npm run build to ensure no build errors
  - [ ] Run npm run lint to verify code quality
  - [ ] Run npm run type-check to ensure TypeScript compliance
  - [ ] Run npm run test to verify all tests pass
  - [ ] Verify all 58 slash commands work in Claude Code

## Dev Notes

### Slash Command Implementation Strategy

**Command Categories and Counts**:
- **10 Agent Commands**: /analyst, /architect, /dev, /pm, /qa, /sm, /ux-expert, /bmad-master, etc.
- **20 Task Commands**: /create-doc, /execute-checklist, /brownfield-create-epic, etc.
- **15 Template Commands**: /architecture, /prd, /story, /front-end-spec, etc.
- **7 Checklist Commands**: /architect-checklist, /pm-checklist, /story-dod-checklist, etc.
- **6 Workflow Commands**: /greenfield-fullstack, /brownfield-service, etc.
- **Total**: 58 slash commands

**Claude Code Integration Pattern**:
```typescript
interface SlashCommand {
  name: string;
  description: string;
  parameters?: SlashCommandParameter[];
  execute: (args: any) => Promise<any>;
}

class BmadSlashCommandRegistry {
  registerCommand(command: SlashCommand): void;
  discoverCommands(): SlashCommand[];
  executeCommand(name: string, args: any): Promise<any>;
}
```

### Resource Loading Strategy

**Agent Commands** [Source: .bmad-core/agents/]:
```typescript
// Example: /analyst command
async executeAnalystCommand(args: any): Promise<string> {
  const agentPath = path.join(projectRoot, '.bmad-core/agents/analyst.md');
  const agentContent = await fs.readFile(agentPath, 'utf-8');
  return this.activateAgent('analyst', agentContent, args);
}
```

**Task Commands** [Source: .bmad-core/tasks/]:
```typescript
// Example: /create-doc command  
async executeCreateDocCommand(args: any): Promise<string> {
  const taskPath = path.join(projectRoot, '.bmad-core/tasks/create-doc.md');
  const taskContent = await fs.readFile(taskPath, 'utf-8');
  return this.executeTask('create-doc', taskContent, args);
}
```

### Integration Points

**Claude Code Command System**:
- Need to research Claude Code's slash command registration API
- Commands should appear in command palette with descriptions
- Support parameter passing and validation
- Handle command conflicts gracefully

**BMAD Resource Integration**:
- All commands load resources from .bmad-core directory
- Maintain existing BMAD tool functionality
- Preserve parameter patterns and user interactions
- Keep elicitation workflows intact

### File Locations

**Files to Create**:
- Command Registry: `src/services/BmadSlashCommandRegistry.ts`
- Agent Commands: `src/tools/slash/agents/` directory (10 files)
- Task Commands: `src/tools/slash/tasks/` directory (20 files)  
- Template Commands: `src/tools/slash/templates/` directory (15 files)
- Checklist Commands: `src/tools/slash/checklists/` directory (7 files)
- Workflow Commands: `src/tools/slash/workflows/` directory (6 files)
- Base Classes: `src/tools/slash/BaseSlashCommand.ts`

**Files to Modify**:
- Server Registration: `src/server.ts` (register slash command system)
- Tool Exports: `src/tools/index.ts` (add slash command exports)

## Testing

### Test Cases Required

**Command Registration Tests**:
- Slash command discovery and registration
- Command name uniqueness validation
- Parameter schema validation
- Integration with Claude Code command system

**Agent Command Tests**:
- Each of the 10 agent commands
- Agent persona loading and activation
- Parameter passing to agent contexts
- Agent state management

**Task Command Tests**:
- Each of the 20 task commands
- Task loading and execution
- Parameter validation and processing
- Task output formatting

**Template Command Tests**:
- Each of the 15 template commands
- Template loading and instantiation
- Variable substitution and processing
- Template output generation

**Checklist Command Tests**:
- Each of the 7 checklist commands
- Checklist loading and execution
- Progress tracking and validation
- Checklist completion reporting

**Workflow Command Tests**:
- Each of the 6 workflow commands
- Workflow loading and orchestration
- Stage execution and transitions
- Workflow state management

**Integration Tests**:
- End-to-end slash command execution
- Resource loading from .bmad-core
- Claude Code integration compatibility
- No conflicts with existing commands

## Change Log

| Date       | Version | Description                                        | Author |
| ---------- | ------- | -------------------------------------------------- | ------ |
| 2025-07-21 | 1.0     | Initial story creation for slash command integration | Claude |